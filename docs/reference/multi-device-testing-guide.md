# マルチデバイステストガイド

## 概要

PCとスマホを使って2つのユーザーアカウントで感謝メッセージのリアルタイム動作を確認する手順です。

## 前提条件

- 開発サーバーが起動していること（`npm run dev -- --port 3001`）
- 2つの異なるGoogleアカウントまたはメールアドレスが利用可能であること
- PCとスマホが同じネットワーク（Wi-Fi）に接続されていること

## テスト手順

### 1. 環境準備

#### PCでの準備
1. ブラウザで `http://localhost:3001` にアクセス
2. 最初のGoogleアカウント（ユーザー1）でログイン
3. プロフィール設定で表示名を設定（例：「太郎」）

#### スマホでの準備
1. PCのIPアドレスを確認
   ```bash
   # ターミナルで実行
   ifconfig | grep "inet " | grep -v 127.0.0.1
   ```
2. スマホのブラウザで `http://[PCのIPアドレス]:3001` にアクセス
   - 例：`http://192.168.1.100:3001`
3. 2つ目のGoogleアカウント（ユーザー2）でログイン
4. プロフィール設定で表示名を設定（例：「花子」）

### 2. パートナー招待

#### PC（ユーザー1）で実行
1. メインページで「パートナーを招待」をクリック
2. 招待リンクをコピー
3. スマホに招待リンクを送信（メール、メッセージアプリなど）

#### スマホ（ユーザー2）で実行
1. 招待リンクをタップしてアクセス
2. 招待を受諾
3. パートナー関係が確立されることを確認

### 3. 家事の追加と完了

#### PC（ユーザー1）で実行
1. 「家事を追加」で新しい家事を作成
   - 例：「洗濯物を干す」
2. 家事リストに表示されることを確認

#### スマホ（ユーザー2）で実行
1. 家事リストが自動更新されることを確認（リアルタイム同期）
2. 追加された家事の「完了」ボタンをタップ
3. 家事が完了状態になることを確認

### 4. 感謝メッセージのテスト

#### PC（ユーザー1）で確認
1. 家事が完了されたことがリアルタイムで反映されることを確認
2. 通知センターに「家事が完了されました」の通知が表示されることを確認
3. 「ありがとう」ボタンをクリック

#### 感謝メッセージ送信
1. 感謝メッセージフォームが表示されることを確認
2. 以下のパターンをテスト：
   - **定型メッセージ選択**：定型メッセージボタンをクリックして送信
   - **カスタムメッセージ**：自由入力でメッセージを作成して送信
   - **空メッセージ**：空のまま送信してバリデーションエラーを確認

#### スマホ（ユーザー2）で確認
1. 感謝メッセージがリアルタイムで受信されることを確認
2. 通知センターに感謝メッセージの通知が表示されることを確認
3. 感謝履歴ページで送受信履歴を確認

### 5. 双方向テスト

#### スマホ（ユーザー2）から家事追加
1. スマホで新しい家事を追加
2. PCでリアルタイム反映を確認

#### PC（ユーザー1）が家事完了
1. PCで家事を完了
2. スマホで通知受信を確認
3. スマホから感謝メッセージを送信
4. PCで感謝メッセージ受信を確認

## 確認ポイント

### リアルタイム同期
- [ ] 家事の追加がリアルタイムで同期される
- [ ] 家事の完了がリアルタイムで同期される
- [ ] 感謝メッセージがリアルタイムで受信される
- [ ] 通知がリアルタイムで表示される

### UI/UX
- [ ] スマホでのレスポンシブデザインが適切に動作する
- [ ] タッチ操作が正常に動作する
- [ ] フォームの入力・送信が正常に動作する
- [ ] エラーメッセージが適切に表示される

### アクセシビリティ
- [ ] キーボードナビゲーションが機能する
- [ ] スクリーンリーダー対応のARIA属性が設定されている
- [ ] フォーカス管理が適切に動作する

### パフォーマンス
- [ ] ページ読み込み時間が許容範囲内
- [ ] リアルタイム通知の遅延が2秒以内
- [ ] UI操作のレスポンスが良好

## トラブルシューティング

### スマホからアクセスできない場合
1. PCとスマホが同じWi-Fiネットワークに接続されているか確認
2. PCのファイアウォール設定を確認
3. IPアドレスが正しいか確認

### リアルタイム同期が動作しない場合
1. ブラウザの開発者ツールでWebSocketエラーを確認
2. Supabaseの接続状況を確認
3. ページをリロードして再接続を試行

### 認証エラーが発生する場合
1. 異なるGoogleアカウントを使用しているか確認
2. ブラウザのキャッシュをクリア
3. プライベートブラウジングモードで試行

## 参考情報

- [感謝機能の仕様](./thank-you-feature.md)
- [リアルタイム機能のトラブルシューティング](../devlog/realtime-troubleshooting-log.md)
- [アクセシビリティテストガイド](./08-test-strategy-and-guidelines.md)